(function(){var e,l,u,t,o,a,s,i,h,n,c,v,y,r,f,p=[].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1};u=!0;t=!1;i=function(){if(u&&!t)return f()===""?history.replaceState(null,null,"?".concat(n())):n()!==f()&&history.pushState(null,null,"?".concat(n())),r()};n=function(){return $("#content select, #content input").serialize()};r=function(){return $("body").css("cursor","wait"),$.getJSON($("#BaseURL").text()+"reports/results/",n()).done(function(n){return $("body").css("cursor","default"),$("#results").empty(),$("#results").html(n.html),$.each(n.objects,function(n,t){var i,r;r=t[0];i=t[1];switch(r){case"plotly":return Plotly.plot(i.renderTo,i.data,i.layout,i.config);case"dashboard":return ANdash.createDashboard(i)}})}).fail(function(n,t,i){var r;return $("body").css("cursor","default"),r=t+", "+i,alert("Error Occurred: "+r)})};a=function(){var i,r,u,t;return t=document.getElementById("report_title"),i=t!==null?"<!--- Embedded BMON Chart: "+t.innerText+" --->":"<!--- Embedded BMON Chart --->",u='<script src="'+$("#BaseURL").text()+"reports/embed/?"+n()+'" style="width: 930px" async><\/script>',r=$("<div class='popup' title='Copy and paste this text to embed this view in a Custom Report:'><textarea id='embed_link' rows=5 style='width: 99%;font-size: 85%;resize: vertical'>"+i+"&#010;"+u+"&#010;<\/textarea><\/div>"),r.dialog({modal:!0,width:750,buttons:{"Copy to Clipboard":function(){return $("#embed_link").select(),document.execCommand("copy")}},close:function(){return $(this).dialog("destroy").remove()}})};c=function(n,t){for(var u,r,i=0,f=n.length;i<f;i++)u=n[i],r=document.getElementById($.trim(u)),t?$(r).show().find("select, input:visible").prop("disabled",!1):$(r).hide().find("select, input").prop("disabled",!0);return t};e=6e5;o=setInterval(r,e);l={minWidth:300,selectedList:3,close:i};h=function(){var t,n,f;return c(["refresh","ctrl_sensor","ctrl_avg","ctrl_avg_export","ctrl_normalize","ctrl_occupied","xy_controls","time_period","download_many"],!1),t=$("#select_chart").find("option:selected"),f=t.data("ctrls").split(","),c(f,!0),clearInterval(o),t.data("timed_refresh")===1&&(o=setInterval(r,e)),u=t.data("auto_recalc")===1,n=$("#select_sensor"),t.data("multi_sensor")===1?n.attr("multiple")!=="multiple"&&(n.off(),n.attr("multiple","multiple"),n.multiselect(l)):n.attr("multiple")==="multiple"&&(n.multiselect("destroy"),n.removeAttr("multiple"),n.off().change(i)),u===!1&&$("#results").empty(),i()};y=function(){var n;return n=$("#BaseURL").text()+"chart-sensor-list/"+$("#select_group").val()+"/"+$("#select_bldg").val()+"/",$.ajax({url:n,dataType:"json",async:!t,success:function(n){return $("#select_chart").html(n.charts),$("#select_sensor").html(n.sensors),$("#select_sensor_x").html(n.sensors),$("#select_sensor_y").html(n.sensors),h()}})};v=function(){var n;return n=$("#BaseURL").text()+"bldg-list/"+$("#select_group").val()+"/",$.ajax({url:n,dataType:"html",async:!t,success:function(n){return $("#select_bldg").html(n),t?void 0:$("#select_bldg").trigger("change")}})};$(window).on("popstate",function(){return s(),r()});f=function(){var n,t;return t=window.location.href,n=t.indexOf("?")+1,n>0?t.substr(n):""};s=function(){var n,r,s,u,e,h,i,o;for(i={},$.each(f().replace(/\+/g,"%20").split("&"),function(){var n,t,r;t=this.split("=");n=decodeURIComponent(t[0]);r=t.length>1?decodeURIComponent(t[1]):null;n in i||(i[n]=[]);i[n].push(r)}),o=function(){var n,t=["select_group","select_bldg","select_chart"];for(n in i)p.call(t,n)<0&&t.push(n);return t}(),t=!0,r=0,s=o.length;r<s;r++)u=o[r],n=$("[name='"+u+"']"),i.hasOwnProperty(u)&&(e=i[u],h=n.parent().attr("class")==="ui-buttonset"?n.filter(":radio:checked").val():n.val(),h!=e&&(n.val(e),n.attr("multiple")==="multiple"&&n.multiselect("refresh"))),n.change();return t=!1,i};$(function(){var e,f,t,u,o;for($(document).tooltip(),$("#time_period").buttonset(),$("#start_date").datepicker({dateFormat:"mm/dd/yy"}),t=new Date,$("#start_date").val(t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()),$("#end_date").datepicker({dateFormat:"mm/dd/yy"}),$("#time_period").change(function(){return $("input:radio[name=time_period]:checked").val()!=="custom"?$("#custom_dates").hide().find("select, input").prop("disabled",!0):$("#custom_dates").show().find("select, input").prop("disabled",!1)}),$("#time_period").change(),$("#refresh").button().click(r),$("#get_embed_link").click(a),$("#normalize").button(),$("#show_occupied").button(),$("#div_date").datepicker({dateFormat:"mm/dd/yy"}),$("#download_many").button().click(function(){return window.location.href=$("#BaseURL").text()+"reports/results/?"+n()}),$("#select_group").change(v),$("#select_bldg").change(y),$("#select_chart").change(h),f=["averaging_time","averaging_time_export","normalize","show_occupied","select_sensor","select_sensor_x","select_sensor_y","averaging_time_xy","div_date","time_period"],u=0,o=f.length;u<o;u++)e=f[u],$("#"+e).change(i);return s(),history.replaceState(null,null,"?".concat(n())),i()})}).call(this);
//# sourceMappingURL=bmsapp.min.js.map
